<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Ćwiczenia</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container">
		<h1>Ćwiczenia</h1>
		<div class="row">
			<div class="col-md-4">
				<div class="form-group">
					<label for="pushups">Pompki (sek)</label>
					<input type="number" class="form-control" id="pushups" placeholder="Podaj czas pompkowania">
				</div>
			</div>
			<div class="col-md-4">
				<div class="form-group">
					<label for="squats">Przysiady (sek)</label>
					<input type="number" class="form-control" id="squats" placeholder="Podaj czas przysiadowania">
				</div>
			</div>
			<div class="col-md-4">
				<div class="form-group">
					<label for="jumpingJacks">Pajacyki (sek)</label>
					<input type="number" class="form-control" id="jumpingJacks" placeholder="Podaj czas pajacowania">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<button type="button" class="btn btn-primary" id="start">Start</button>
				<button type="button" class="btn btn-secondary" id="pause">Pauza</button>
				<button type="button" class="btn btn-danger" id="reset">Reset</button>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<h2 id="info"></h2>
				<h1 id="timer">00:00</h1>
			</div>
		</div>
	</div>

	<script>
		$(document).ready(function(){
			var exercises = [
				{label: "Pompki", time: 0},
				{label: "Przysiady", time: 0},
				{label: "Pajacyki", time: 0}
			];
			var timerDiv = $("#timer");
			var infoDiv = $("#info");
			var intervalId;
			var elapsedTime = 0;
			var i = 0;
			
			// Funkcja odliczająca czas
			function countdown(time, callback){
				startTime = Date.now();
				intervalId = setInterval(function(){
					var remainingTime = time - Math.floor((Date.now() - startTime + elapsedTime) / 1000);
					if(remainingTime <= 0){
						clearInterval(intervalId);
						callback();
					} else {
						var minutes = Math.floor(remainingTime / 60);
						var seconds = remainingTime % 60;
						var minutesStr = minutes < 10 ? "0" + minutes : minutes;
						var secondsStr = seconds < 10 ? "0" + seconds :	seconds;
					timerDiv.text(minutesStr + ":" + secondsStr);
				}
			}, 100);
		}
		
		// Funkcja uruchamiana po zakończeniu ćwiczenia
		function exerciseEnd(){
			elapsedTime = 0;
			timerDiv.text("00:00");
			if(i < exercises.length - 1){
				infoDiv.text("Następne ćwiczenie za 20 sekund: " + exercises[i+1].label);
				setTimeout(function(){
					infoDiv.text("");
					i++;
					countdown(exercises[i].time, exerciseEnd);
				}, 20000);
			} else {
				infoDiv.text("Koniec ćwiczeń!");
			}
		}
		
		// Funkcja obsługująca kliknięcie przycisku Start
		$("#start").click(function(){
			exercises[0].time = parseInt($("#pushups").val());
			exercises[1].time = parseInt($("#squats").val());
			exercises[2].time = parseInt($("#jumpingJacks").val());
			i = 0;
			countdown(exercises[0].time, exerciseEnd);
		});

		// Funkcja obsługująca kliknięcie przycisku Pauza
		$("#pause").click(function(){
			clearInterval(intervalId);
			elapsedTime += Date.now() - startTime;
		});

		// Funkcja obsługująca kliknięcie przycisku Reset
		$("#reset").click(function(){
			clearInterval(intervalId);
			elapsedTime = 0;
			i = 0;
			infoDiv.text("");
			timerDiv.text("00:00");
		});
	});
</script>

